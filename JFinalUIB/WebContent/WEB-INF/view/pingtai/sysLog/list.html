<% include("/common/splitPage.html"){} %>

<form id="splitPage" class="form-horizontal" action="${cxt}/jf/sysLog" method="POST">
	
	<div>
		<ul class="breadcrumb">
			<li><a href="#" onclick="ajaxUrl('/jf/index/content');">主页</a> <span class="divider">/</span></li>
			<li>
				<a href="#">分组管理</a>
			</li>
		</ul>
	</div>
	
	<div class="row-fluid sortable">
		<div class="box span12">
			<div class="box-header well" data-original-title>
				<h2><i class="icon-edit"></i> 日志查询</h2>
				<div class="box-icon">
					<a href="#" class="btn btn-minimize btn-round"><i class="icon-chevron-down"></i></a>
					<a href="#" class="btn btn-close btn-round"><i class="icon-remove"></i></a>
				</div>
			</div>
			<div class="box-content" style="display: none;">
				<fieldset>
				  	<div class="control-group">
						<label class="control-label" for="focusedInput">功能名称</label>
						<div class="controls">
					  		<input class="input-xlarge focused" type="text" name="_query.names" value='${paramMap["_query.names"]}' maxlength="20" >
						</div>
				  	</div>
				  	
				  	<div class="control-group">
						<label class="control-label" for="focusedInput">用户名称</label>
						<div class="controls">
					  		<input class="input-xlarge focused" type="text" name="_query.username" value='${paramMap["_query.username"]}' maxlength="20" >
						</div>
				  	</div>
				  	
				  	<div class="form-actions">
						<button type="button" class="btn btn-primary" onclick='ajaxForm("splitPage");'>查询</button>
						<button type="reset" class="btn">清除</button>
				  	</div>
				</fieldset>
			</div>
		</div><!--/span-->
	</div><!--/row-->
	
	<div class="row-fluid sortable">
		<div class="box span12">
			
			<div class="box-header well" data-original-title>
				<h2><i class="icon-user"></i> 日志列表</h2>
				<div class="box-icon">
					<a href="#" class="btn btn-minimize btn-round"><i class="icon-chevron-up"></i></a> 
					<a href="#" class="btn btn-close btn-round"><i class="icon-remove"></i></a>
				</div>
			</div>
			
			<div class="box-content">
				<table class="table table-striped table-bordered bootstrap-datatable ">
					<thead>
						<tr>
							<th onclick="orderbyFun('onames')">
								功能
				      			<bu:splitOrder name="onames" />
							</th>
							<th width="100" onclick="orderbyFun('u.username')">
								用户
				      			<bu:splitOrder name="u.username" />
							</th>
							<th width="35" onclick="orderbyFun('status')">
								状态
				      			<bu:splitOrder name="status" />
							</th>
							<th width="100" onclick="orderbyFun('ips')">
								IP
				      			<bu:splitOrder name="ips" />
							</th>
							<th width="150" onclick="orderbyFun('startDate')">
								时间
				      			<bu:splitOrder name="startDate" />
							</th>
							<th width="45" onclick="orderbyFun('actionHaoShi')">
								控制器
				      			<bu:splitOrder name="actionHaoShi" />
							</th>
							<th width="40" onclick="orderbyFun('viewHaoShi')">
								视图
				      			<bu:splitOrder name="viewHaoShi" />
							</th>
							<th width="45" onclick="orderbyFun('haoShi')">
								总耗时
				      			<bu:splitOrder name="haoShi" />
							</th>
							<th width="140">操作</th>
						</tr>
					</thead>
					<tbody>
						<c:set var="view" scope="page">
							<bu:hasPrivilegeBool url="/jf/sysLog/view"/>
						</c:set>
						<c:set var="delete" scope="page">
							<bu:hasPrivilegeBool url="/jf/sysLog/delete"/>
						</c:set>
						<c:forEach items="${splitPage.page.list}" var="record">
							<tr>
								<td align="center">${record.columns["onames"] }：${record.columns.ourl }</td>
								<td align="center">${record.columns["username"] }</td>
								<td align="center">
									<c:choose>
										<c:when test='${record.columns["status"] eq "1"}'>
											<span class="label label-success">成功</span>
										</c:when>
										<c:when test='${record.columns["status"] eq "0"}'>
											<span class="label label-warning">失败</span>
										</c:when>
									</c:choose>
								</td>
								<td align="center">${record.columns["ips"] }</td>
								<td align="center">
									<fmt:formatDate value='${record.columns["startdate"]}' type="both" pattern="yyyy-MM-dd HH:mm:ss:SSS"/>
								</td>
								<td align="center">${record.columns["actionhaoshi"] }</td>
								<td align="center">${record.columns["viewhaoshi"] }</td>
								<td align="center">
									<c:choose>
										<c:when test='${record.columns["haoshi"] > 1000}'>
											<span class="label label-warning">${record.columns["haoshi"] }</span>
										</c:when>
										<c:otherwise>
											<span class="label label-success">${record.columns["haoshi"] }</span>
										</c:otherwise>
									</c:choose>
								</td>
								<td class="center">
									<c:if test='${pageScope.view eq "true"}'>
										<a class="btn btn-success" href="#" onclick="ajaxUrl('/jf/sysLog/view/${record.columns.ids}');"> <i class="icon-zoom-in icon-white"></i> 查看</a> 
									</c:if>
									<c:if test='${pageScope.delete eq "true"}'>
										<a class="btn btn-danger" href="#" onclick="ajaxUrl('/jf/sysLog/delete/${record.columns.ids}');"> <i class="icon-trash icon-white"></i> 删除</a>
									</c:if>
								</td>
							</tr>
						<% } %>
					</tbody>
				</table>
				<div id="splitPageDiv" class="pagination pagination-centered"></div>
			</div>
			
		</div>
		<!--/span-->
	
	</div>
	<!--/row-->

</form>